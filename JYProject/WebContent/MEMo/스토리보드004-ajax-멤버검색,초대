ㅁ 프로젝트/업무 멤버추가 
<<<프로젝트 멤버추가>> 
-멤버검색
테이블로 작성
멤버가 아니면 추가버튼, 멤버이면 멤버취소 버튼 
->@ 멤버 중복 체크 (초대하려는 유저가 멤버리스트에 있는지 체크 ) 
-> 프로젝트/업무에 소속된 유저 번호(or 아이디?)를 배열에 담아둠 .  //#### 어떻게?????  -> ajax에서 종류가 다른 데이터를 두개 받을 수 있는지??
-> 중복 : group by jyp_no 해주기 

///////////////////////////////////////////////////
2단으로 나눠 각 테이블 생성

ㅁ 소속멤버
이름/소속/직함/프로젝트권한 (관리자,멤버)/취소

@ 현재워크스페이스 멤버이며 현재 프로젝트 소속된 멤버리스트 
1. 
select jyp_no from p_member where p_no = 9 and ws_no=1 and jyp_no>0;    //and jyp_no!=4;

2. 현재워크스페이스 멤버이며 현재 프로젝트 소속된 멤버리스트 
ex) 2번 워크스페이스에  8번 프로젝트에 소속된 멤버들의 정보 
select*from jyp_member
where jyp_no in (select jyp_no from p_member where p_no = 8 and ws_no=2 and jyp_no>0)
+--------+-----------+----------+----------+---------+--------+------------+---------------------+---------------+------+----------+
| jyp_no | jyp_email | jyp_name | jyp_pass | jyp_tel | gender | birth      | jyp_date            | jyp_ip        | dept | position |
+--------+-----------+----------+----------+---------+--------+------------+---------------------+---------------+------+----------+
|      4 | 44@44     | 44       | 44       | 44      | 여자   | 2020-07-16 | 2020-07-19 15:21:11 | 192.168.3.103 | -    | -        |
|      3 | 333@333   | 333      | 333      |         | 여자   | 1999-03-02 | 2020-07-19 15:19:38 | 192.168.3.103 | -    | -        |
+--------+-----------+----------+----------+---------+--------+------------+---------------------+---------------+------+----------+
2 rows in set (0.00 sec)


@p_mem삭제
-삭제되기 전에 체크 할 사항-  @관리자가 몇 명인지 뽑기 (리턴값 int###dao만들어야됨)
 -> select count(*) from p_member where p_no = ? and p_access = 1;   
 ex) 프로젝트 8번의 관리자 권한 멤버 수 
 mysql> select count(*) from p_member where p_no = 8 and p_access = 1;
+----------+
| count(*) |
+----------+
|        1 |
+----------+
1 row in set (0.01 sec)

-만약 관리자가 1명 있다면 관리자는 삭제 X(그럼 삭제하려는 유저의 권한도 알아야될듯)-> 알림창 띄움 

*삭제되는 순서*
1.@삭제하려는 유저의 권한체크 
	-> select p_access from p_member where p_no = 8 and jyp_no = ? 
	ex) 회원번호 4인 유저가 프로젝트 8번에서의 권한 
	mysql> select p_access from p_member where p_no = 8 and jyp_no = 4;
	+----------+
	| p_access |
	+----------+
	|        1 |
	+----------+
	1 row in set (0.00 sec)
	
2.IF)관리자 권한이라면 관리자가 2명이상인지 체크하고 1명만 있으면 삭제X 2명이상이면 삭제O  
	0.	@삭제
-일반 멤버는 그냥 조건문 안거치고 삭제

ㅁ소속X멤버
이름/소속/직함/초대

@ 현재워크스페이스 멤버이며 현재 프로젝트에는소속이 안된 멤버리스트 					
select*from p_member where p_no != 9 and ws_no=1 and jyp_no>0; and jyp_no!=4;


select*from jyp_member
where jyp_no =(select jyp_no from p_member where p_no = 8 and ws_no=2 and jyp_no>0)


select jyp_no from p_member where jyp_no != (p_no = 8 and ws_no=2 and jyp_no>0)
QQQQQQQQQQQQQQQQq
->여러값 동시에 부정하는 방법 

/////아니면 (ajax에) ws_member리스트만 가져와서 거기서 p_no소속인 멤버 아닌 멤버를 나누어야하는지 ? 


>>1번의 워크스페이스에 소속된 멤버들의 jyp_member 정보 
select*from jyp_member where jyp_no in (select jyp_no from ws_member where ws_no=2)   -> 3,4,6
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+
| jyp_no | jyp_email     | jyp_name | jyp_pass | jyp_tel     | gender | birth      | jyp_date            | jyp_ip        | dept | position |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+
|      4 | 44@44         | 44       | 44       | 44          | 여자   | 2020-07-16 | 2020-07-19 15:21:11 | 192.168.3.103 | -    | -        |
|      3 | 333@333       | 333      | 333      |             | 여자   | 1999-03-02 | 2020-07-19 15:19:38 | 192.168.3.103 | -    | -        |
|      6 | aaa@naver.com | 에이     | 1212     | 01012121212 | 남자   | 1990-09-09 | 2020-07-27 00:08:15 | 192.168.3.107 | -    | -        |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+
3 rows in set (0.00 sec)
/////////
>>>>
>>1번의 워크스페이스에 소속된 멤버들의 p_member 정보 
mysql> select*From p_member where ws_no=2;
+-------+------+--------+----------+---------------------+---------------+
| ws_no | p_no | jyp_no | p_access | p_Mdate             | p_Mip         |
+-------+------+--------+----------+---------------------+---------------+
|     2 |    6 |      0 |        1 | 2020-08-05 16:58:12 | 192.168.43.70 |
|     2 |    8 |      4 |        1 | 2020-08-05 17:00:26 | 192.168.3.103 |
|     2 |    9 |      4 |        1 | 2020-08-05 17:01:23 | 192.168.3.103 |
|     2 |    8 |      3 |        2 | 2020-08-05 23:10:40 | 192.168.3.103 |
+-------+------+--------+----------+---------------------+---------------+
4 rows in set (0.00 sec)

//////////////////////////////
>>1번의 워크스페이스(jyp_workspaced의 ws_no=1)에 소속된 멤버들의  jyp_member, p_member 정보조회 

select jm.*, pm.* 
from jyp_member jm left join p_member pm
using(jyp_no)
group by jm.jyp_no
having jm.jyp_no in (select jyp_no from ws_member where ws_no=2);


+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
| jyp_no | jyp_email     | jyp_name | jyp_pass | jyp_tel     | gender | birth      | jyp_date            | jyp_ip        | dept | position | ws_no | p_no | jyp_no | p_access | p_Mdate             | p_Mip         |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
|      1 | jyp_email     | 22       | 11       | 22          | 남자   | 2020-01-02 | 2020-07-19 15:06:50 | 192.168.3.103 | 22   | 22       |  NULL | NULL |   NULL |     NULL | NULL                | NULL          |
|      3 | 333@333       | 333      | 333      |             | 여자   | 1999-03-02 | 2020-07-19 15:19:38 | 192.168.3.103 | -    | -        |     2 |    8 |      3 |        2 | 2020-08-05 23:10:40 | 192.168.3.103 |
|      4 | 44@44         | 44       | 44       | 44          | 여자   | 2020-07-16 | 2020-07-19 15:21:11 | 192.168.3.103 | -    | -        |     1 |    2 |      4 |        1 | 2020-08-05 12:12:29 | 192.168.3.103 |
|      5 | Zoo@naver.com | 주연     | wndusl   | 01011112222 | 여자   | 1995-09-07 | 2020-07-19 17:15:32 | 192.168.3.103 | -    | -        |  NULL | NULL |   NULL |     NULL | NULL                | NULL          |
|      6 | aaa@naver.com | 에이     | 1212     | 01012121212 | 남자   | 1990-09-09 | 2020-07-27 00:08:15 | 192.168.3.107 | -    | -        |  NULL | NULL |   NULL |     NULL | NULL                | NULL          |
|      8 | bb@naver.com  | b        | 1212b    | 22222222    | 여자   | 1991-06-02 | 2020-07-30 23:43:01 | 192.168.3.111 | -    | -        |  NULL | NULL |   NULL |     NULL | NULL                | NULL          |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
6 rows in set (0.01 sec)






/////////
select*
from jyp_member jm join p_member pm
group by jm.jyp_no
where jyp_no in (select jyp_no from ws_member where ws_no=1) 


//////////
mysql> select jyp_no from ws_member where ws_no=1;
+--------+
| jyp_no |
+--------+
|      4 |
|      3 |
|      6 |
+--------+


////////////////////

select*
from jyp_member jm join p_member pm
group by jm.jyp_no
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
| jyp_no | jyp_email     | jyp_name | jyp_pass | jyp_tel     | gender | birth      | jyp_date            | jyp_ip        | dept | position | ws_no | p_no | jyp_no | p_access | p_Mdate             | p_Mip         |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
|      1 | jyp_email     | 22       | 11       | 22          | 남자   | 2020-01-02 | 2020-07-19 15:06:50 | 192.168.3.103 | 22   | 22       |     1 |    1 |      0 |        1 | 2020-08-05 12:02:16 | 192.168.43.70 |
|      3 | 333@333       | 333      | 333      |             | 여자   | 1999-03-02 | 2020-07-19 15:19:38 | 192.168.3.103 | -    | -        |     1 |    1 |      0 |        1 | 2020-08-05 12:02:16 | 192.168.43.70 |
|      4 | 44@44         | 44       | 44       | 44          | 여자   | 2020-07-16 | 2020-07-19 15:21:11 | 192.168.3.103 | -    | -        |     1 |    1 |      0 |        1 | 2020-08-05 12:02:16 | 192.168.43.70 |
|      5 | Zoo@naver.com | 주연     | wndusl   | 01011112222 | 여자   | 1995-09-07 | 2020-07-19 17:15:32 | 192.168.3.103 | -    | -        |     1 |    1 |      0 |        1 | 2020-08-05 12:02:16 | 192.168.43.70 |
|      6 | aaa@naver.com | 에이     | 1212     | 01012121212 | 남자   | 1990-09-09 | 2020-07-27 00:08:15 | 192.168.3.107 | -    | -        |     1 |    1 |      0 |        1 | 2020-08-05 12:02:16 | 192.168.43.70 |
|      8 | bb@naver.com  | b        | 1212b    | 22222222    | 여자   | 1991-06-02 | 2020-07-30 23:43:01 | 192.168.3.111 | -    | -        |     1 |    1 |      0 |        1 | 2020-08-05 12:02:16 | 192.168.43.70 |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
6 rows in set (0.01 sec)
///////

mysql> select jm.*, pm.*
    -> from jyp_member jm join p_member pm
    -> using(jyp_no)
    -> group by ;
+--------+-----------+----------+----------+---------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
| jyp_no | jyp_email | jyp_name | jyp_pass | jyp_tel | gender | birth      | jyp_date            | jyp_ip        | dept | position | ws_no | p_no | jyp_no | p_access | p_Mdate             | p_Mip         |
+--------+-----------+----------+----------+---------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
|      3 | 333@333   | 333      | 333      |         | 여자   | 1999-03-02 | 2020-07-19 15:19:38 | 192.168.3.103 | -    | -        |     2 |    8 |      3 |        2 | 2020-08-05 23:10:40 | 192.168.3.103 |
|      4 | 44@44     | 44       | 44       | 44      | 여자   | 2020-07-16 | 2020-07-19 15:21:11 | 192.168.3.103 | -    | -        |     1 |    2 |      4 |        1 | 2020-08-05 12:12:29 | 192.168.3.103 |
+--------+-----------+----------+----------+---------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
2 rows in set (0.00 sec)
/////

--   



/////////////////★★★★★★★★★★★★★★
mysql> select jm.*, pm.*
	     from jyp_member jm left join p_member pm
	     using(jyp_no)
	     group by jm.jyp_no
	     having jm.jyp_no in (select jyp_no from ws_member where ws_no=2);
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
| jyp_no | jyp_email     | jyp_name | jyp_pass | jyp_tel     | gender | birth      | jyp_date            | jyp_ip        | dept | position | ws_no | p_no | jyp_no | p_access | p_Mdate             | p_Mip         |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
|      3 | 333@333       | 333      | 333      |             | 여자   | 1999-03-02 | 2020-07-19 15:19:38 | 192.168.3.103 | -    | -        |     2 |    8 |      3 |        2 | 2020-08-05 23:10:40 | 192.168.3.103 |
|      4 | 44@44         | 44       | 44       | 44          | 여자   | 2020-07-16 | 2020-07-19 15:21:11 | 192.168.3.103 | -    | -        |     1 |    2 |      4 |        1 | 2020-08-05 12:12:29 | 192.168.3.103 |
|      6 | aaa@naver.com | 에이   		  | 1212     | 01012121212 | 남자   | 1990-09-09 | 2020-07-27 00:08:15 | 192.168.3.107 | -    | -        |  NULL | NULL |   NULL |     NULL | NULL                | NULL          |
+--------+---------------+----------+----------+-------------+--------+------------+---------------------+---------------+------+----------+-------+------+--------+----------+---------------------+---------------+
3 rows in set (0.01 sec)

///★★★★★ 정리 
 select jm.jyp_no,jm.jyp_email,jm.jyp_name, jm.dept, jm.position, pm.p_no,pm.p_access
	     from jyp_member jm left join p_member pm
	     using(jyp_no)
	     group by pm.jyp_no
	     having jm.jyp_no in (select jyp_no from ws_member where ws_no=2)
	    

///다시정리 ★★★★★
 select jm.jyp_no,jm.jyp_email,jm.jyp_name, jm.dept, jm.position, pm.p_no,pm.p_access
	     from jyp_member jm left join p_member pm
	     using(jyp_no)
	     where  jm.jyp_no in (select jyp_no from ws_member where ws_no=2)  ;


//////////ws_no 나오는 ver 
 select jm.jyp_no,jm.jyp_email,jm.jyp_name, jm.dept, jm.position, pm.p_no,pm.p_access, wm.ws_no
	     from jyp_member jm left join ws_member wm 
	      using(jyp_no)
	     					left join p_member pm
	     using(jyp_no)
	     where  jm.jyp_no in (select jyp_no from ws_member where ws_no=2);



	    
////★★★★★★★★★★★   프로젝트 멤버 ★★★★★★★★ 
 select jm.jyp_no,jm.jyp_email,jm.jyp_name, jm.dept, jm.position, pm.p_no,pm.p_access
	     from jyp_member jm left join p_member pm
	     using(jyp_no)
	     where  jm.jyp_no  in (select jyp_no from ws_member where ws_no=1) and pm.p_no=13 ;     
////////////////////////////////////
NOT IN
////★★★★★★★★★★★   프로젝트 비멤버 , wm.ws_no★★★★★★★★ 
	     select jm.jyp_no,jm.jyp_email,jm.jyp_name, jm.dept, jm.position, pm.p_no,pm.p_access
	     from jyp_member jm left join ws_member wm 
	      using(jyp_no)
	     					left join p_member pm
	     using(jyp_no)
	     where wm.ws_no=1
	     group by jyp_no
	     having  jm.jyp_no not in (select jyp_no from p_member where p_no=39)
	     
	     
	     
//////////////////////////////////////////

*memberlist 
ㅁ 이미 초대된 멤버라면 
방법1
검색할때 본인아이디 검색하면 초대버튼 안뜨게 하기 or 이미 소속된 유저이면(본인포함) 초대버튼 안뜨게하기 
방법2 ####
초대버튼 누르고 @초대액션으로 넘어가서 초대리스트에 등록하기 전에 초대하려는 워크스페이스에 초래하려는 멤버의 정보가 있는지 체크 
-> 통과되면 등록 
-> 이미 있는 멤버라면 이전페이지
 

///////////////////////////////////////////////////////////////////////////////////////////
<<업무멤버추가>>
@ 현재 프로젝트에 소속된 멤버이며, 해당 업무에 배정된 멤버검색
 select jm.jyp_no,jm.jyp_email,jm.jyp_name, jm.dept, jm.position, pwm.work_no
	     from jyp_member jm left join pw_member pwm
	     using(jyp_no)
	     where  jm.jyp_no  in (select jyp_no from p_member where p_no=19) and pwm.work_no=59 ;  


@ 현재 프로젝트에 소속된 멤버이며, 해당 업무에 배정되어있지 않은멤버 검색 
	     select jm.jyp_no,jm.jyp_email,jm.jyp_name, jm.dept, jm.position, pwm.work_no
	     from jyp_member jm left join  p_member pm
	      using(jyp_no)
	     					left join  pw_member pwm
	     using(jyp_no)
	     where pm.p_no=19
	     group by jyp_no
	     having  jm.jyp_no not in (select jyp_no from pw_member where work_no=59)










